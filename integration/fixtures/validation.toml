[[test]]
name = 'PgParamInExtendedQuery'
query = '''
--! new_author
INSERT INTO Author (id, name) VALUES (:id, $1);
'''
error = '''
Error while validating queries [path: "queries/module_1.sql"]:
 --> 2:45
  | 
  | INSERT INTO Author (id, name) VALUES (:id, $1);
  |                                             ^---
  | 
  = Cannot mix bind parameter syntaxes in the same query.
  = Please use either named (`:named_ident`) or indexed (`$n`) bind parameters, but not both.'''

[[test]]
name = 'ExtendedParamInPgQuery'
query = '''
--! new_author(id, name)
INSERT INTO Author (id, name) VALUES ($1, :name);
'''
error = '''
Error while validating queries [path: "queries/module_1.sql"]:
 --> 2:44
  | 
  | INSERT INTO Author (id, name) VALUES ($1, :name);
  |                                            ^---
  | 
  = Cannot mix bind parameter syntaxes in the same query.
  = Please use either named (`:named_ident`) or indexed (`$n`) bind parameters, but not both.'''

[[test]]
name = 'InvalidI16Index'
query = '''
--! new_author(id, name)
INSERT INTO Author (id, name) VALUES ($1, $10000);
'''
error = '''
Error while validating queries [path: "queries/module_1.sql"]:
 --> 2:44
  | 
  | INSERT INTO Author (id, name) VALUES ($1, $10000);
  |                                            ^---
  | 
  = Index is higher than the number of parameters supplied (2).'''

[[test]]
name = 'DuplicateCol'
query = '''
--! new_author(id, id)
INSERT INTO Author (id, name) VALUES ($1, $2);
'''
migration = '''
CREATE TABLE author (
  id SERIAL,
  name TEXT
);
'''
error = '''
Error while validating queries [path: "queries/module_1.sql"]:
 --> 1:20
  | 
  | --! new_author(id, id)
  |                    ^---
  | 
  = Column name is already used.'''

[[test]]
name = 'MoreBindParamsThanParams'
query = '''
--! new_author(id, name)
INSERT INTO Author (id, name) VALUES ($1, $3);
'''
error = '''
Error while validating queries [path: "queries/module_1.sql"]:
 --> 2:44
  | 
  | INSERT INTO Author (id, name) VALUES ($1, $3);
  |                                            ^---
  | 
  = Index is higher than the number of parameters supplied (2).'''

[[test]]
name = 'UnusedParam'
query = '''
--! new_author(id, name, other)
INSERT INTO Author (id, name) VALUES ($1, $2);
'''
error = '''
Error while validating queries [path: "queries/module_1.sql"]:
 --> 1:26
  | 
  | --! new_author(id, name, other)
  |                          ^---
  | 
  = Parameter `$3` is never used in the query.'''

[[test]]
name = 'ColumnAlreadyNullable'
query = '''
--! new_author: (id?, name?, id?)
SELECT id, name FROM Author;
'''
migration = '''
CREATE TABLE author (
  id SERIAL,
  name TEXT
);
'''
error = '''
Error while validating queries [path: "queries/module_1.sql"]:
 --> 1:30
  | 
  | --! new_author: (id?, name?, id?)
  |                              ^---
  | 
  = Column name is already used.'''

[[test]]
name = 'InvalidNullableColumnName'
query = '''
--! new_author: (name?)
SELECT id FROM Author;
'''
migration = '''
CREATE TABLE author (
  id SERIAL,
  name TEXT
);
'''
error = '''
Error while validating queries [path: "queries/module_1.sql"]:
 --> 1:18
  | 
  | --! new_author: (name?)
  |                  ^---
  | 
  = No column named `name` found for this query.'''
